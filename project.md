# 1. 全天空极光图像聚类分析及异常事件检测
## 1.1 全天空极光图像预处理

## 1.2 全天空极光图像聚类分析
### 1.2.1 极光特征提取

### 1.2.1 聚类分析
#### 1.2.1.1 常用聚类算法
##### 1.2.1.1.1 K-means 
##### 1.2.1.1.2 Mean-Shift
##### 1.2.1.1.3 DBSCAN(Density-Based Spatial Clustering of Applications with Noise/基于密度的带噪声的空间聚类的应用) 
##### 1.2.1.1.4 基于高斯混合模型(GMM)的期望最大化(EM)聚类
##### 1.2.1.1.5 凝聚层次聚类

## 1.3 全天空极光图像异常事件检测

# 2. SMILE卫星地基极光数据传输/分析平台
## 2.1 平台主要模块的功能及设计
### 2.1.1 数据分析客户端
1. Keogram处理
2. 可视化处理
3. 实时监控

### 2.1.2 网络传输客户端
1. 极光文件网络传输

## 2.2 主要功能的技术实现细节
### 2.2.1 开发框架选择
1. 为什么要用Qt开发这个平台？
	1. 因为极地端的电脑主要是Linux系统(OpenSUSE)，考虑到跨平台开发的效率，选择Qt这个快平台的开发框架。
	2. 平台主要功能是极光图像的处理与传输，考虑到C++在图像处理方面的语言优势还有现有的大量的图形图像处理库(Opencv等)，选择Qt。
	3. Qt命名，继承，类的组织等方面保持了优秀的一致性，这对项目中面向对象实现功能提供了大量可用的优秀接口。

### 2.2.2 极光可视化处理
1. 使用OpenCV做了什么工作？
	1. 对指定站点、波段、时间段的极光数据实现从图像到视频的转换。

2. 具体怎么样把图像转换成了视频？
	1. 定义一个VideoWriter类对象，指明视频存储路径和名称，视频存储格式和图片大小。
	2. 定义一个MAT帧对象，使用imread()函数向这个帧中写入一张图片数据。
	3. 把MAT帧对象中的数据写入VideoWriter类对象。重复执行2、3，直到所有图片都处理完成。

3. 极光3D投影是怎么样的功能？为什么用OSG实现？
	1. 极光3D投影是将指定站点、波段和时间段的极光数据投影在立体的地球表面，有一种极光再现的3D效果。
	2. 选用OSG(OpenSceneGraph)是因为OSG完全基于OpenGL开发，它封装了OpenGL的所有特性，提供了小部分OpenGL接口。
	3. OSG开源免费。
	4. OSG是基于C++开发的，与项目主体兼容。

4. 具体怎么样把极光图像投影在了3D的地球图像上？
	1. 太空场景仿真
		1. 
		2. 工程实现时，在每一帧的渲染中应该首先渲染太空背景，在渲染其他场景，并且保证后渲染的像素遮盖先渲染的像素。
		3. 黑色的太空背景使用清除颜色缓存来实现，并将清除颜色设置为黑色。
		4. 随机产生星星的坐标，然后为生成的小正方形贴上星星纹理。

	2. 地球仿真
		1. 绘制球体
			1. 在球坐标系中，有规律地选取一系列坐标点，每次在这些坐标中选取相距最近的三个点，组成一个三角形，这一系列坐标可以组成无数个三角形，这些小三角形就形成了一个球面。
			2. 在进行由地球平面图向3D地球转换时，需要进行直角坐标系坐标和球坐标系坐标之间的转换。在划分三角形面元时需要确定对球坐标系方位角和仰角的采样频率，最终综合考虑视觉效果和计算效率，选取的采样周期为10°。
			3. 
		2. 添加纹理
			1. 在一张图上采样像素值，将这些像素值绘制到球体的每个三角面元上。
			2. 
		3. 添加公告板效果
			1. 公告板(Billboard)技术，通常是利用多边形总是朝向观察者这一特性，来达到某些特定的效果。公告板技术指出：在场景运动过程中，物体始终保持与实现垂直，观察者始终从正面观察物体，而不会从侧面看到物体。这样就实现了物体的三维显示，这样做的好处是，无需计算物体的内部结构，大大减少了计算量。这项技术常用于渲染游戏中地上的草和远处的山。
			2. 
		4. 添加辉光效果
			1. 人眼能看见实体，是因为实体反射的光线进入了人眼，反射光线与视角夹角越大人眼感知到的光线越弱。当夹角大于90°时，人眼就无法感知到光线，也就形成了实体的背面。
			2. 

	3. 极光仿真
		1. 极光伪彩色图生成
			1. 对极光图像进行伪彩色增强时，依次读取每幅极光图片，并将图片的RGB与这个阈值进行比较，在这个阈值之外的像素舍弃。而在这个阈值之内的像素读取，并重新为像素赋值，使得像素的RGB接近黄绿色，因为黄绿色与真实的极光现象是比较接近的。经过这样处理之后，我们就得到了可以作为纹理的图片。
		2. 添加极光纹理
			1. 为什么不选用粒子系统？
			2. 纹理贴图的工作方式

```cpp
// 太空场景仿真关键代码
// 设置首先渲染太空图层
camera->setRenderOrder(osg::Camera::PRE_RENDER);
// 太空背景颜色设置
camera->setClearColor(osg::Vec4(0.0,0.0,0.0,1.0)); //黑色完全不透明的太空背景
// 生成球形
osg::ref_ptr<osg::Drawable> sphere = new osg::ShapeDrawable(new osg::Sphere(osg::Vec3(0.0, 0.0, 0.0), 0.7));  //球心坐标及半径
// 添加公告板效果
osg::Billboard* sunBillboard = new osg::Billboard();
sunBillboard->setMode(osg::Billboard::POINT_ROT_EYE);
sunBillboard->addDrawable(
createSquare(osg::Vec3(-0.85f,0.0f,-0.85f), osg::Vec3(1.7f,0.0f,0.0f), osg::Vec3(0.0f,0.0f,1.7f), createBillboardImage( osg::Vec4( 1.0, 1.0, 1.0, 1.0f), 64, 1.0) ), osg::Vec3(0.0f,0.0f,0.0f));
osg::Group *root = new osg::Group;
root->addChild(earth);
root->addChild(sunBillboard);
```
### 2.2.3极光数据传输
1. 文件传输用什么协议实现的？
	1. 极光文件传输是基于FTP实现的，

2. 控制消息传输为什么要用MQTT协议实现？
	1. 因为时间和经费问题，选择MQTT实现远程监控模块的消息传输，而不用HTTP。
	2. MQTT协议是轻量、简单、开放和易于实现的，这些特点使它适用范围非常广泛。在很多情况下，包括受限的环境中，如：机器与机器通信和物联网、通过卫星链路通信传感器、偶尔拨号的医疗设备、智能家居、及一些小型化设备中已广泛使用。
	3. MQTT对不稳定网络环境的容忍度要比HTTP高很多，MQTT能够从断开等故障中恢复，而且没有进一步的代码需求。但是，HTTP 无法原生地实现此目的，需要客户端重试编码。
	4. 实验室有搭建好的用于物联网MQTT服务器，方面早期测试。
3. 


## 2.3 相关其他问题
### 2.3.1 工程里面有没有用到什么设计模式？是怎么样实现？
1. 远程监控模块中用到了**单例模式**。
	1. 在远程监控监控模块中，首先定义了一个基类MQTT管理器，这个管理器支持登录/登出服务器，发布/订阅消息，添加/删除Topic，存储Topic操作。 MQTT管理器类一个抽象基类，因为存在纯虚函数 这是一个抽象基类，因为存在纯虚函数MqttManager::connectToHost。 因此这个类不能生成对象， 需要继承这个类，并在子类中实现纯虚函数。我们分别现了两个子类YRMqttManager和RTEMqttManager。YRMqttManager是用于北极黄河站光数据传输MQTT管理 器；RTEMqttManager是用于科考站点实时监控MQTT管理器。为了保证在一个模块中只会存MQTT管理器，我们使用了“单例 模式”。
2. 

### 2.3.2 网络相关
#### 2.3.2.1 MQTT协议有什么缺点或者不足呢？
1. 没有齐备的SDK，不同的异构终端，需要有对应的与MQTT服务器通信的软件SDK包，比如MCU、Linux、Android、IOS、WEB等之间要实现互联互通必然需要不同的SDK包
2. 不支持File和AV，有些应用场景，需要传输的信息可能不仅仅限于指令，比如声音信号和视频信号，这些需要通过File和AV来实现通信。
3. 不支持与第三方HTTP的集成，虽然MQTT协议优于普通的HTTP协议，但是基于传统的HTTP协议的WEB服务器仍然占主流市场，那么这些服务器要实现与MQTT协议的互联互通，以降低升级成本也尤为关键。
4. 不支持负载均衡，为防止高并发和恶意攻击，负载均衡服务器也必不可少。
5. 不支持用户管理接口，用户在进行设备的行为数据分析的时候，显得尤为重要，这又是工业4.0、大数据时代的必然需求。
6. 不支持离线消息，弥补设备离线以后，MQTT服务器对设备的控制信息丢失的问题。
7. 不支持点对点通信，采用标准的MQTT协议，理论上可以通过相互订阅的方式实现点对点通信，但是逻辑相对复杂，并且对设备的安全性方面存在担忧。当设备B和设备C在同一主题的情况下，设备A无法知道是设备B还是设备C发送的消息，也有可能消息被设备D窃听。
8. 不支持群通信和群管理，实现了对群组成员的管理，群组成员之间能互通消息，这在一个设备被多人控制，或者多个设备被一人控制的这种场景下，尤为有用。

#### 2.3.2.2 MQTT和HTTP相比较有什么相同和不同的？


# 3. 基于眼部特征的疲劳驾驶检测系统
## 3.1 系统主要模块的功能及设计

## 3.2 